define(["jquery","core/config","core/log"],function(a,b,c){var d=function(){},e=new d;return e.init=function(){function d(){var b=a("#slot_overview tbody"),c=a("#show_past_slots").is(":checked"),d=a("#show_my_slots_only").is(":checked"),h=a("#show_free_slots_only").is(":checked"),i=a("#show_hidden_slots").is(":checked");b.find("tr").show(),i||b.find("tr:not(.info).unavailable").hide(),c||b.find("tr.past_due").hide(),d&&b.find("tr.not_my_slot").hide(),h&&b.find("tr.not_free_slot").hide();var j=a(".organizer_filtertable");if(j){var k=j.val().toUpperCase();if(k){var l,m,n,o,p,q=b.find("tr:visible:not(.info)");for(l=0;l<q.length;l++){if(p=!1,n=q[l].getElementsByTagName("td"))for(m=0;m<n.length;m++)if(o=f(n[m]),o&&o.toUpperCase().indexOf(k)>-1){p=!0;break}p||a(q[l]).hide()}}}b.show(),e(),g("mod_organizer_showhiddenslots",i),g("mod_organizer_showmyslotsonly",d),g("mod_organizer_showfreeslotsonly",h),g("mod_organizer_showpasttimeslots",c)}function e(){var b=a("#slot_overview tbody"),c=b.find("tr:not(.info)"),d=0===c.length,e=!1;c.each(function(){0===a(this).css("offsetWidth")&&0===a(this).css("offsetHeight")&&"none"!==a(this).css("display")||(e=!0)});var f=a("#show_past_slots").is(":checked"),g=a("#show_my_slots_only").is(":checked");b.find("tr.info").hide(),e||(d?b.find("tr.no_slots_defined").show():f&&!g?b.find("tr.no_slots").show():f&&g?b.find("tr.no_my_slots").show():!f&&g?b.find("tr.no_due_my_slots").show():b.find("tr.no_due_slots").show())}function f(b){var c,d,e;if(d=a(b).clone().find("script,style").remove().end(),c=d.text(),!c){e=d.find("img:not(.icon)").first();var f=e.attr("alt");"undefined"!=typeof f&&f!==!1&&(c=f)}return c}function g(d,e){a.get(b.wwwroot+"/lib/ajax/setuserpref.php",{sesskey:b.sesskey,pref:encodeURI(d),value:encodeURI(e)},"json").done(function(a){"OK"!=a&&c.error(a)})}a("#show_past_slots").on("click",d),a("#show_my_slots_only").on("click",d),a("#show_free_slots_only").on("click",d),a("#show_hidden_slots").on("click",d),a(".organizer_filtertable").on("keyup",d),d()},e});