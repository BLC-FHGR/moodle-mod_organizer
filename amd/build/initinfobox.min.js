define(["jquery","core/config","core/log"],function(a,b,c){var d=function(){this.student=0},e=new d;return e.init=function(d){function f(){var b=a("#slot_overview tbody"),c=a("#show_past_slots").is(":checked"),d=a("#show_my_slots_only").is(":checked"),f=a("#show_free_slots_only").is(":checked"),j=a("#show_hidden_slots").is(":checked"),k=a("#show_registrations_only").is(":checked");b.find("tr").show(),k?b.find("tr:not(.registered)").hide():b.find("tr.registered").show(),j||b.find("tr:not(.info).unavailable").hide(),c||b.find("tr.past_due").hide(),d&&(e.student||b.find("tr.not_my_slot").hide()),f&&b.find("tr.not_free_slot").hide();var l=a(".organizer_filtertable");if(l){var m=l.val().toUpperCase();if(m){var n,o,p,q,r,s=b.find("tr:visible:not(.info)");for(n=0;n<s.length;n++){if(r=!1,p=s[n].getElementsByTagName("td"))for(o=0;o<p.length;o++)if(q=h(p[o]),q&&q.toUpperCase().indexOf(m)>-1){r=!0;break}r||a(s[n]).hide()}}}b.show(),g(),i("mod_organizer_showhiddenslots",j),e.student||i("mod_organizer_showmyslotsonly",d),i("mod_organizer_showfreeslotsonly",f),i("mod_organizer_showpasttimeslots",c),i("mod_organizer_showregistrationsonly",k)}function g(){var b=a("#slot_overview tbody"),c=b.find("tr:not(.info)"),d=0===c.length,e=!1;c.each(function(){0===a(this).css("offsetWidth")&&0===a(this).css("offsetHeight")&&"none"!==a(this).css("display")||(e=!0)});var f=a("#show_past_slots").is(":checked"),g=a("#show_my_slots_only").is(":checked");b.find("tr.info").hide(),e||(d?b.find("tr.no_slots_defined").show():f&&!g?b.find("tr.no_slots").show():f&&g?b.find("tr.no_my_slots").show():b.find("tr.no_due_slots").show())}function h(b){var c,d,e;if(d=a(b).clone().find("script,style").remove().end(),c=d.text(),!c){e=d.find("img:not(.icon)").first();var f=e.attr("alt");"undefined"!=typeof f&&f!==!1&&(c=f)}return c}function i(d,e){a.get(b.wwwroot+"/lib/ajax/setuserpref.php",{sesskey:b.sesskey,pref:encodeURI(d),value:encodeURI(e)},"json").done(function(a){"OK"!=a&&c.error(a)})}e.student=d,a("#show_past_slots").on("click",f),a("#show_my_slots_only").on("click",f),a("#show_free_slots_only").on("click",f),a("#show_hidden_slots").on("click",f),a("#show_registrations_only").on("click",f),a(".organizer_filtertable").on("keyup",f),f()},e});